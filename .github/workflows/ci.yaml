name: "CI Workflow"

on:
  push:
    branches:
      - "master"
  workflow_dispatch:  

jobs:
  build-and-test:
    uses: ./.github/workflows/build-and-test.yaml

  sonar-analysis:
    uses: ./.github/workflows/sonarqube-analysis.yaml
    secrets:
      SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
      SONAR_HOST_URL: ${{ secrets.SONAR_HOST_URL }}
    needs: build-and-test

  # deploy:
    # uses: ./deploy-to-cloud-run.yml
    # needs: sonar-analysis 
